<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BizDeck</title>
    <link rel="stylesheet" href="component.css" />
    <link rel="stylesheet" href="home.css" />
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="./assets/img/BizDeck_logo.svg" rel="shortcut icon" type="image/x-icon">
</head>
<body>
    <section class="phone">
        <section class="header">
            <p class="page_name">Home</p>
            <img src="./assets/img/bell.png" class="bell">
        </section>
        <section class="body">
            <p class="slogan">Turning Cards into<br>Connections</p>
            <div class="my_card_case">
                <div class="my_card_case_header">
                    <div class="my_card_edit" onclick="location.href='setting.html'">
                        <p class="Edit_text">Edit</p>
                    </div>
                    <div class="my_card_switch" onclick="Switch()"> <!-- 카드큐알 스위치 -->
                        <div class="card_qr_switch">
                            <img src="./assets/img/card_button.svg" id="card">
                            <img src="./assets/img/qr_button.svg" id="qr" style="display: none;">
                        </div>
                    </div>
                </div>
                <div class="my_card" id="my_card" style="margin-top: 16px;">
                    <div class="my_name text_item">
                        <p class="my_name_text text_item">Name</p>
                    </div>
                    <div class="my_job">
                        <p class="my_job_text text_item">Job</p>
                    </div>
                    <div class="contact_case">
                        <div class="contact">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M17.1654 4.27559C17.1667 4.82646 16.9458 5.35474 16.5522 5.7415L15.7673 6.52332C15.4938 6.7961 15.141 6.97584 14.7589 7.03737C14.3769 7.09874 13.9851 7.03858 13.6395 6.86551L12.6583 6.37692V6.37676C12.354 6.224 12.0983 5.99017 11.9196 5.70101C11.741 5.41201 11.6464 5.07923 11.6465 4.73976V4.02521C10.6476 3.75697 9.61468 3.63559 8.58055 3.66483C7.54627 3.63558 6.51339 3.75697 5.5144 4.02521V4.73976C5.51516 5.0809 5.42022 5.41551 5.24039 5.70571C5.06055 5.99607 4.80284 6.2305 4.49655 6.38282L3.51539 6.87141V6.87157C3.25797 6.99856 2.97482 7.0654 2.68758 7.06706C2.19982 7.06661 1.73229 6.87323 1.38751 6.52954L0.608696 5.74772C0.208576 5.34902 -0.011133 4.80494 0.000434735 4.24119C0.0119978 3.6776 0.253753 3.14291 0.670001 2.76089C2.4484 1.10553 4.48424 0 8.58047 0C12.6767 0 14.7125 1.10553 16.4909 2.76089C16.9177 3.15021 17.162 3.69927 17.1654 4.27559ZM15.9389 11.6053V15.2702C15.9389 15.7562 15.7451 16.2222 15.4002 16.5659C15.0552 16.9095 14.5873 17.1026 14.0994 17.1026H3.06175C2.57384 17.1026 2.10599 16.9095 1.76095 16.5659C1.41604 16.2222 1.22221 15.7562 1.22221 15.2702V11.6053C1.22191 11.4626 1.27181 11.3244 1.36325 11.2144L4.42924 7.54948V7.54963C4.54609 7.41005 4.71908 7.32943 4.9015 7.32973H6.12791V6.10812C6.12791 5.88989 6.24476 5.68819 6.43448 5.57906C6.6242 5.46994 6.85789 5.46994 7.04761 5.57906C7.23733 5.68817 7.35433 5.88988 7.35433 6.10812V7.32973H9.8072V6.10812C9.8072 5.88989 9.92404 5.68819 10.1138 5.57906C10.3035 5.46992 10.5372 5.46994 10.7269 5.57906C10.9166 5.68817 11.0336 5.88988 11.0336 6.10812V7.32973H12.26H12.2599C12.4423 7.32943 12.6154 7.41005 12.7321 7.54963L15.7981 11.2145V11.2144C15.8896 11.3244 15.9395 11.4626 15.9392 11.6053H15.9389ZM11.0335 12.2161C11.0335 11.5682 10.775 10.9467 10.3151 10.4886C9.85505 10.0303 9.23109 9.773 8.58069 9.773C7.93013 9.773 7.30618 10.0303 6.84627 10.4886C6.38621 10.9467 6.12786 11.5682 6.12786 12.2161C6.12786 12.8641 6.3862 13.4856 6.84627 13.9437C7.30621 14.402 7.93013 14.6593 8.58069 14.6593C9.23109 14.6593 9.85505 14.402 10.3151 13.9437C10.7751 13.4856 11.0335 12.8641 11.0335 12.2161Z" fill="black"/>
                            </svg>
                            <div class="contact_text">
                                <p class="contact_text_text text_item">010-0000-0000</p>
                            </div>
                        </div>
                        <div class="contact">
                            <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 19" fill="none">
                                <g clip-path="url(#clip0_466_1686)">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M10.0335 10.8774H17.2177C17.3221 10.8774 17.423 10.8913 17.5194 10.9168L13.5417 13.7578L9.61607 10.9547C9.74607 10.9053 9.88661 10.8781 10.0332 10.8781L10.0335 10.8774ZM9.64928 1.33006C12.3798 1.97168 14.5284 4.11203 15.173 6.83144C14.2774 6.15766 12.8691 5.62157 11.1699 5.31761C10.8647 3.62548 10.3267 2.22165 9.64954 1.33013L9.64928 1.33006ZM10.3041 5.18669C9.55342 5.09222 8.75866 5.04168 7.93552 5.04168C7.11238 5.04168 6.31703 5.09222 5.56696 5.18669C6.00587 2.78072 6.90151 1.13269 7.93552 1.13269C8.96953 1.13269 9.86577 2.78145 10.3041 5.18669ZM4.70139 5.31834C3.00261 5.62228 1.59381 6.15825 0.698244 6.83218C1.34239 4.11295 3.49115 1.97253 6.22198 1.3308C5.54556 2.22293 5.00735 3.62566 4.70164 5.31827L4.70139 5.31834ZM7.93999 15.9458H7.9299C6.89817 15.9402 6.00412 14.2938 5.56635 11.8918C6.31702 11.9863 7.11178 12.0369 7.93491 12.0369H8.0041V15.9438C7.98291 15.9456 7.96173 15.9466 7.93996 15.9466L7.93999 15.9458ZM6.22117 15.7476C3.49126 15.106 1.34242 12.9656 0.698171 10.2462C1.59381 10.92 3.00261 11.4561 4.70131 11.76C5.00645 13.4522 5.54452 14.856 6.2211 15.7475L6.22117 15.7476ZM0.499287 8.53932C0.499287 7.50936 2.15453 6.61663 4.56995 6.18003C4.47511 6.92776 4.42438 7.71941 4.42438 8.53991C4.42438 9.35986 4.47569 10.1515 4.56995 10.8992C2.15453 10.462 0.499287 9.56988 0.499287 8.53991V8.53932ZM5.43375 6.04779C6.21567 5.94829 7.0573 5.89445 7.93508 5.89445C8.81286 5.89445 9.65449 5.94887 10.4364 6.04779C10.5363 6.82665 10.5903 7.66542 10.5903 8.53991C10.5903 9.04929 10.5719 9.54591 10.5369 10.0264H10.0327C9.22682 10.0264 8.52633 10.5008 8.19956 11.1831C8.11149 11.1842 8.0227 11.1848 7.93406 11.1848C7.05628 11.1848 6.2141 11.1304 5.43273 11.0314C5.33285 10.2526 5.27879 9.41426 5.27879 8.53991C5.27879 7.66556 5.33342 6.82668 5.43273 6.04779L5.43375 6.04779ZM11.3006 6.18002C13.7161 6.61721 15.3713 7.50935 15.3713 8.53931C15.3713 9.09033 14.8972 9.60261 14.0864 10.0258H11.3899C11.4272 9.54359 11.4468 9.04641 11.4468 8.53931C11.4468 7.71936 11.3961 6.92716 11.3012 6.17943L11.3006 6.18002ZM18.2306 11.4576C18.3332 11.6309 18.3923 11.8326 18.3923 12.0475V16.5165C18.3923 16.7265 18.336 16.9242 18.2372 17.0948L15.1537 13.6544L18.2306 11.4567L18.2306 11.4576ZM17.5753 17.6305C17.4626 17.6666 17.3429 17.686 17.2185 17.686H10.0343C9.86305 17.686 9.6996 17.6488 9.55243 17.5821L12.627 14.1511L13.2862 14.6216C13.4318 14.7304 13.6365 14.7378 13.7916 14.6272L14.4586 14.1511L17.5761 17.6299L17.5753 17.6305ZM8.95433 16.9755C8.89351 16.8344 8.85949 16.6794 8.85949 16.5166V12.0477C8.85949 11.8677 8.90071 11.6971 8.97494 11.5443L11.9302 13.6553L8.95421 16.9762L8.95433 16.9755Z" fill="black"/>
                                </g>
                                <defs>
                                <clipPath id="clip0_466_1686">
                                <rect width="18.8921" height="18.8182" fill="white"/>
                                </clipPath>
                                </defs>
                            </svg>
                            <div class="contact_text">
                                <p class="contact_text_text text_item">Email</p>
                            </div>
                        </div>
                        <div class="contact">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <g clip-path="url(#clip0_466_1688)">
                                <path d="M16.456 17.4485H1.38631C1.16687 17.4485 0.947424 17.3392 0.801094 17.157C0.654757 16.9749 0.618273 16.7562 0.691376 16.5376C1.7521 12.7484 5.15376 10.0887 8.92126 10.0887C12.6888 10.0887 16.0903 12.7484 17.1511 16.5376C17.2242 16.7562 17.1511 16.9748 17.0414 17.157C16.8951 17.3392 16.7121 17.4485 16.4561 17.4485H16.456ZM2.37392 16.0276H15.4687C14.3347 13.3314 11.7378 11.5098 8.9213 11.5098C6.10483 11.5098 3.5079 13.3315 2.37392 16.0276Z" fill="black"/>
                                <path d="M12.7985 17.4484H5.04399C4.82455 17.4484 4.64159 17.3756 4.4954 17.1934C4.34907 17.0476 4.31258 16.829 4.31258 16.6104C4.86117 12.6755 6.72666 10.0522 8.88474 10.0522C11.0428 10.0522 12.8718 12.6755 13.4569 16.6104C13.4935 16.829 13.4203 17.0113 13.2741 17.1934C13.2007 17.3755 12.9813 17.4484 12.7985 17.4484H12.7985ZM5.92183 16.0275H11.9569C11.4084 13.3678 10.2012 11.5097 8.95765 11.5097C7.67751 11.5097 6.47046 13.3679 5.92173 16.0275H5.92183Z" fill="black"/>
                                <path d="M8.92125 17.157C8.51885 17.157 8.1897 16.8291 8.1897 16.4283V10.7809C8.1897 10.3801 8.51886 10.0522 8.92125 10.0522C9.32363 10.0522 9.65279 10.3801 9.65279 10.7809V16.4283C9.65279 16.8291 9.3235 17.157 8.92125 17.157Z" fill="black"/>
                                <path d="M16.4559 17.4485H1.38621C0.800995 17.4485 0.325484 16.9748 0.325484 16.3919L0.325348 6.51799C0.325348 6.11716 0.654505 5.78931 1.05689 5.78931H16.8218C17.2242 5.78931 17.5533 6.11718 17.5533 6.51799V16.3916C17.5168 16.9746 17.0414 17.4482 16.456 17.4482L16.4559 17.4485ZM1.75177 16.0276H16.0903V7.24674H1.75177V16.0276Z" fill="black"/>
                                <path d="M16.7852 7.24692H1.05691C0.65451 7.24692 0.325363 6.91905 0.325363 6.51824V1.38116C0.325363 0.798235 0.800875 0.324585 1.38609 0.324585H16.4561C17.0413 0.324585 17.5168 0.798235 17.5168 1.38116V6.51824C17.517 6.91906 17.1877 7.24692 16.7854 7.24692H16.7852ZM1.75179 5.82601H16.0903V1.74557H1.75179V5.82601Z" fill="black"/>
                                <path d="M13.5666 4.47787H13.1642C12.7618 4.47787 12.4327 4.15 12.4327 3.74919C12.4327 3.34838 12.7618 3.02051 13.1642 3.02051H13.5666C13.969 3.02051 14.2982 3.34838 14.2982 3.74919C14.2982 4.15 13.9324 4.47787 13.5666 4.47787Z" fill="black"/>
                                <path d="M10.2382 4.47787H9.83583C9.43343 4.47787 9.10428 4.15 9.10428 3.74919C9.10428 3.34838 9.43344 3.02051 9.83583 3.02051H10.2382C10.6406 3.02051 10.9698 3.34838 10.9698 3.74919C10.9698 4.15 10.6405 4.47787 10.2382 4.47787Z" fill="black"/>
                                </g>
                                <defs>
                                <clipPath id="clip0_466_1688">
                                <rect width="17.8426" height="17.7727" fill="white"/>
                                </clipPath>
                                </defs>
                            </svg>
                            <div class="contact_text">
                                <p class="contact_text_text text_item">Website</p>
                            </div>
                        </div>
                    </div>
                    <div class="logo">
                        <img src="./assets/img/BizDeck_logo.svg" class="logo_img">
                    </div>
                </div>

                <!-- QR 영역 -->
                <div id="qrArea"></div>

            </div>
            <p class="card_list_title">Recent watched</p>
            <div class="card_list">
                <!-- 명함 -->
                <div class="friend_cards" id="friend_cards"></div>
            </div>
        </section>
        <section class="footer">
            <div class="choice">
                <p class="footer_text">Home</p>
            </div>
            <img src="./assets/img/home_choice.png" class="home_button">
            <img src="./assets/img/card_list.png" class="card_list_button" onclick="location.href='card_list.html'">
            <img src="./assets/img/setting.png" class="setting_button" onclick="location.href='setting.html'">
        </section>
    </section>
    
    
<!-- QRCode.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<!-- home.js (메인 JS 파일) -->
<script type="module" src="home.js"></script>

<!-- QR 스위치 로직 (auth 선언 X) -->
<script type="module">
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
  const auth = getAuth();             
  let currentUser = null;             

  onAuthStateChanged(auth, (user) => {
    currentUser = user;
  });

  // ❗ Switch 는 window에 등록해야 HTML onclick 이 동작함
  window.Switch = function () {
    const btn     = document.querySelector('.card_qr_switch');  
    const card    = document.getElementById('card');           
    const qr      = document.getElementById('qr');             
    const my_card = document.getElementById('my_card');
    const qrArea  = document.getElementById('qrArea');

    btn.classList.toggle('qr');

    if (btn.classList.contains('qr')) {
      if (!currentUser) {
        alert("로그인 후에 QR을 사용할 수 있습니다.");
        
        if (event && event.preventDefault) event.preventDefault();

        btn.classList.remove('qr');
        window.location.replace("https://creamy-tim.github.io/BizDeck/");
        return false;
        return;
      }

      const qrText = "https://creamy-tim.github.io/BizDeck/qr/card.html?id=" + encodeURIComponent(currentUser.uid);

      card.style.display = 'none';
      qr.style.display = 'block';
      my_card.style.display = 'none';

      qrArea.innerHTML = '';
      qrArea.style.display = 'block';

      new QRCode(qrArea, {
        text: qrText,
        correctLevel: QRCode.CorrectLevel.H
      });

      qrArea.addEventListener("click", () => window.location.href = qrText);

    } else {
      card.style.display = 'block';
      qr.style.display = 'none';
      my_card.style.display = 'block';
      qrArea.style.display = 'none';
      qrArea.innerHTML = '';
    }
  };
</script>

</body>
</html>